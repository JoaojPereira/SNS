let
    GlossarioMetricas = #table(
        {"M√©trica", "Defini√ß√£o", "F√≥rmula DAX"},
        {
            {"Total Atendimentos", "Soma total de epis√≥dios de urg√™ncia hospitalar no per√≠odo analisado", "SUM(FactAtendimentosUrgencia[TotalAtendimentos])"},
            {"Atendimentos N√£o Urgentes", "Soma dos epis√≥dios classificados como n√£o urgentes (Verde, Azul, Branca)", "[Atendimentos Verde] + [Atendimentos Azul] + [Atendimentos Branca]"},
            {"% N√£o Urgentes", "Percentagem de atendimentos classificados como n√£o urgentes", "DIVIDE([Atendimentos N√£o Urgentes], [Total Atendimentos], 0)"},
            {"Custo Desperdi√ßado com N√£o Urgentes", "Valor financeiro desperdi√ßado por casos n√£o urgentes (Diferencial 150‚Ç¨ vs 30‚Ç¨)", "VAR AtendimentosNaoUrgentes = [Atendimentos N√£o Urgentes]; VAR CustoUrgencia = 150; VAR CustoCentroSaude = 30; VAR DiferencaCusto = CustoUrgencia - CustoCentroSaude; RETURN AtendimentosNaoUrgentes * DiferencaCusto"},
            {"Despesa Total Estimada", "Estimativa da despesa total das urg√™ncias hospitalares (Base 150‚Ç¨/epis√≥dio)", "[Total Atendimentos] * 150"},
            {"Desperd√≠cio Potencial", "Valor potencialmente desperdi√ßado por atendimentos n√£o urgentes (120‚Ç¨/epis√≥dio)", "[Atendimentos N√£o Urgentes] * 120"},
            {"Tempo Espera M√©dio", "M√©dia dos tempos de espera entre triagem e observa√ß√£o", "CALCULATE(AVERAGE(FactMonitorizacaoSazonal[Valor]), DimIndicador[IndicadorNome] = ""Tempo M√©dio Espera Triagem-Observa√ß√£o"")"},
            {"% Acima Meta 60min", "Percentagem de epis√≥dios com tempo de espera superior a 60 minutos", "VAR TotalLinhas = CALCULATE(COUNTROWS(FactMonitorizacaoSazonal), DimIndicador[IndicadorNome] = ""Tempo M√©dio Espera Triagem-Observa√ß√£o""); VAR LinhasAcima60 = CALCULATE(COUNTROWS(FactMonitorizacaoSazonal), FactMonitorizacaoSazonal[Valor] > 60, DimIndicador[IndicadorNome] = ""Tempo M√©dio Espera Triagem-Observa√ß√£o""); RETURN DIVIDE(LinhasAcima60, TotalLinhas, 0)"},
            {"Total M√©dicos", "Soma total de m√©dicos", "SUM(FactAtendimentosUrgencia[M√©dicos])"},
            {"Total M√©dicos Internos", "Soma total de m√©dicos internos", "SUM(FactAtendimentosUrgencia[MedicosInternos])"},
            {"Total Enfermeiros", "Soma total de enfermeiros", "SUM(FactAtendimentosUrgencia[Enfermeiros])"},
            {"Total Profissionais", "Soma total de m√©dicos, internos e enfermeiros", "[Total M√©dicos] + [Total M√©dicos Internos] + [Total Enfermeiros]"},
            {"Atendimentos por M√©dico", "M√©dia de atendimentos realizados por cada m√©dico", "DIVIDE([Total Atendimentos], [Total M√©dicos], 0)"},
            {"Score Inefici√™ncia Global", "√çndice ponderado (40% N√£o Urgentes, 30% Espera, 15% Produtividade, 15% Custo Desperdi√ßado)", "VAR Score_NaoUrgentes = [% N√£o Urgentes] * 40; VAR Score_TempoEspera = MIN(DIVIDE([Tempo Espera M√©dio], 120, 0), 1) * 30; VAR Score_Produtividade = IF([Registros com RH] > 0, (1 - MIN(DIVIDE([Atendimentos por M√©dico], 500, 0), 1)) * 15, 0); VAR Score_Custos = MIN(DIVIDE([Custo Desperdi√ßado com N√£o Urgentes], [Despesa Efetiva], 0), 1) * 15; RETURN Score_NaoUrgentes + Score_TempoEspera + Score_Produtividade + Score_Custos"},
            {"Status Urg√™ncias Falsas", "Classifica√ß√£o do estado das urg√™ncias falsas por institui√ß√£o", "SWITCH(TRUE(), [% N√£o Urgentes] < 0.25, ""‚úÖ Eficiente (< 25%)"", [% N√£o Urgentes] < 0.35, ""‚ö†Ô∏è Aten√ß√£o (25-35%)"", ""‚ùå Cr√≠tico (> 35%)"")"},
            {"Status R√°cio Enfermeiro/M√©dico", "Classifica√ß√£o do r√°cio de enfermeiros por m√©dico", "SWITCH(TRUE(), [R√°cio Enfermeiro/M√©dico] < 1.5, ""üî¥ CR√çTICO"", [R√°cio Enfermeiro/M√©dico] < 2.0, ""üü° ABAIXO DA META"", ""üü¢ ADEQUADO"")"},
            {"Ranking Score Inefici√™ncia", "Ranking das institui√ß√µes por Score Inefici√™ncia Global", "RANKX(ALL(DimInstituicao[InstituicaoNome]), [Score Inefici√™ncia Global], , DESC, DENSE)"},
            {"Ranking Produtividade", "Ranking das institui√ß√µes por produtividade m√©dica", "RANKX(ALL(DimInstituicao[InstituicaoNome]), [Atendimentos por Profissional], , DESC, DENSE)"},
            {"Picos Sazonais por Regi√£o", "Tabela dos maiores volumes de atendimentos por regi√£o e esta√ß√£o", "(Consultar tabela de picos no relat√≥rio)"},
            {"Atendimentos por Tipo de Dia", "Distribui√ß√£o dos atendimentos por dia √∫til, fim de semana e feriado", "(Consultar visualiza√ß√£o por tipo de dia)"},
            {"Taxa Cobertura RH", "Percentagem de registros com dados v√°lidos de recursos humanos (M√©dicos > 0 E Enfermeiros > 0)", "DIVIDE([Registros com RH V√°lido], COUNTROWS(FactAtendimentosUrgencia), 0)"},
            {"Registros com RH V√°lido", "N√∫mero de registros com dados v√°lidos de recursos humanos", "CALCULATE(COUNTROWS(FactAtendimentosUrgencia), FactAtendimentosUrgencia[Medicos] > 0, FactAtendimentosUrgencia[Enfermeiros] > 0)"},
            {"Institui√ß√µes Sem RH", "N√∫mero de institui√ß√µes sem dados de recursos humanos", "CALCULATE(DISTINCTCOUNT(FactAtendimentosUrgencia[InstituicaoID]), FILTER(ALL(FactAtendimentosUrgencia), FactAtendimentosUrgencia[Medicos] = 0 || FactAtendimentosUrgencia[Enfermeiros] = 0))"},
            {"Valida√ß√£o Total Atendimentos", "Diferen√ßa absoluta entre soma das triagens e total reportado (formato num√©rico, 0 = validado)", "VAR SomaTriagens = [Atendimentos Vermelha] + [Atendimentos Laranja] + [Atendimentos Amarela] + [Atendimentos Verde] + [Atendimentos Azul] + [Atendimentos Branca] + [Atendimentos Sem Triagem]; VAR Diferenca = ABS([Total Atendimentos] - SomaTriagens); RETURN Diferenca"}
        }
    )
in
    GlossarioMetricas
